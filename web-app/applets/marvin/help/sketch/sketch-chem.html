<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>MarvinSketch Help</TITLE>
 <link rel=stylesheet type="text/css" href="../marvinmanuals.css">
</HEAD>
<BODY>
<H1 CLASS="title">Chemical Features of MarvinSketch</H1>

<a HREF="sketch-index.html">Table of Contents</a>
<!--
<H2><A class="anchor" NAME="implicit-explicit-H"></A>Implicit/Explicit Hydrogens</H2>
<P>MarvinSketch has a number of options for the display of implicit and
explicit hydrogens. Because MarvinSketch is chemically intelligent, it will
automatically add hydrogens as necessary within the structure.
Generally, these will be implicit and displayed based on the options
set in the <B class="buttonName">View</B>
menu. 
</P>
<P>To view all hydrogens explicitly, displayed as atoms with bonds to
neighbors, chose <B class="buttonName">Edit
&gt; H-Atoms &gt; Add</B>. The <B class="buttonName">Edit
&gt; H-Atoms &gt; Remove</B> will return to the previous display mode. 
</P>
<P>To view implicit hydrogens by symbol, use the <B class="buttonName">View
&gt; Hydrogens &gt; Implicit </B>menu group. This option
is disabled in Spacefill and Ball &amp; Stick display modes. 
</P>
-->
<H2><A class="anchor" NAME="valence-check">Valence Check</A></H2>
<P>MarvinSketch does not automatically correct valence errors. Instead,
they are highlighted by a red underline and you may make the
appropriate corrections. This option can be turned on or off using the <B class="buttonName">Edit
&gt; Preferences </B> box. 
</P>

<H2><A class="anchor" NAME="charges">Charges</A></H2>
<P>In MarvinSketch, the charge of an atom is initially set to be neutral.
As bonds are added or removed, MarvinSketch adjusts the number of implicit
hydrogens to let the charge remain neutral. You may change the charge
of any atom using the <A HREF="sketch-gui.html#atom.popup" class="buttonName">Atom
Pop-up Menu</A>. The number of implicit hydrogens will
be adjusted, if possible, to accommodate the new charge. MarvinSketch will
then perform a valence check and highlight the atom if an error is
found. 
</P>

<H2><A class="anchor" NAME="reactions">Reactions</A></H2>
<P>MarvinSketch allows you to <a href="sketch-basic.html#howto-draw.reactions">draw reactions</a> in your molecule by placing a
reaction arrow. You can place the reaction arrow in any position,
pointing in any direction. The structures before the arrow will be
considered Reactants, structures along the arrow Agents, and
structures after the arrow as Products. 
</P>
<!--<P>MarvinSketch will determine if the reaction is stoichiometrically valid. The
existence of reaction errors is denoted by a red box around the
arrow. 
This option can be turned on or off using the <B class="buttonName">Edit
&gt; Preferences </B> box.
</P>-->

<H2><A class="anchor" NAME="mapping">Mapping</A></H2>
<P>MarvinSketch allows you to set a map label on any atom in the molecule.
Map labels are useful because they remain constant, unlike atom
indexes, which can change as the molecule is altered. Atom mapping
can be very useful when drawing reactions. It allows you to specify
that specific reactant atoms will become specific product atoms. 
You can assign the same free map number to both of these atoms by pressing the
<A HREF="sketch-gui.html#react.button" class="buttonName">Reaction Button</A>
on the toolbar, then drawing the arrow from the first atom to the second one.
You can also select a Map for an atom from the 
<A HREF="sketch-gui.html#atom.popup" class="buttonName">Atom Pop-up Menu</A>,
or else you can use the <A HREF="sketch-gui.html#edit-popup.menu" class="buttonName">Edit Pop-up Menu</A> to automatically assign map numbers to selected atoms.
You can also use the <A HREF="sketch-basic.html#shortcuts">shortcuts</A> M1, M2, ...
to assign map labels, M0 to remove map labels, M= or M+ to assign unique map numbers.
</P>

<H2><A class="anchor" NAME="isotopes">Isotopes</A></H2>
<P>MarvinSketch allows you to change an atom into one of its isotopes using
the
<A HREF="sketch-gui.html#atom.popup" class="buttonName">Atom
Pop-up Menu</A>.  <br>There is the possibility to extend the isotope list with
custom items. <a href="isotopelist.html">Technical details.</a>
</P>

<H2><A class="anchor" NAME="e-z">E/Z Feature</A></H2>
<P>By choosing <B class="buttonName">View &gt;
Stereo &gt; E/Z Labels </B>, you can toggle the
display of absolute double bond stereoconfiguration labels. Bonds
known to have an (E) or (Z) configuration will be marked as such. 
</P>

<H2><A class="anchor" NAME="sgroups">S-groups</A></H2>
<P>MarvinSketch has a rich collection of features related to
abbreviated groups. 
</P>
<H3>Predefined Abbreviated Groups</H3>
<P>A number of predefined S-groups are available in MarvinSketch. The
complete set is listed under the <B class="buttonName">Groups</B>
menu. These groups are also available as <A HREF="gui/shortcuts.html">shortcuts</A>.
<br>Their usage is described in the <a href="sketch-basic.html#abbreviatedgroups">Basic MarvinSketch</a> page.<br>
The rotation of the molecule might change the groups' writing order, thus retaining 
the chemically correct connectivity. Read a <a href="../formats/abbrevgroup-doc.html">
  detailed description</a> of this feature.
</P>
<H3>User-Defined Abbreviated Groups</H3>
<P>You can easily create new groups that you often use. Select the structure and give it 
a name (<B class="buttonName">Structure &gt; Groups &gt;
Create Group</B>) and if needed, define an attachment point. 
<a href="sketch-basic.html#abbreviatedgroups">Details.</a>
</P>
<H3>S-groups as My Templates</H3>
<P>User-defined groups are, by default, session-only. To retain a
group for future use, add it to <B class="buttonName">My
Templates</B>. This will also make the group available in
the <B class="buttonName">Groups</B>
menu or as a shortcut. 
</P>

<h2><a class="anchor" name="link-nodes">Link Nodes</a></h2>
<p>Link nodes enable specifying query stuctures contaning rings or chains of variable size. In the following example, the number of carbons can be between 1 and 7:</p>
<p><img src="../images/link-node.png"></p>

<H2><a class="anchor" name="groups">Working with Groups</a></H2>
<P>Group manipulation functions are available through the <B class="buttonName">Structure
&gt; Group </B>submenu and by right-clicking on an
existing group.
 <BR>Choosing <B class="buttonName">Contract</B> from the context menu
or <B class="buttonName">Structure &gt; Group &gt; Contract Group</B> from the main menu
contracts one group to its abbreviation if there is one group selected, otherwise contracts all
groups in the molecule.
<BR>Choosing <B class="buttonName">Expand Group</B> from the context menu
or <B class="buttonName">Structure &gt; Group &gt; Expand Group</B> from the main menu
displays the full structure instead of a contracted group if there is one group selected, otherwise expands all
groups in the molecule.

<BR>Selecting <B class="buttonName">Ungroup</B>
will remove all abbreviated groups from the molecule. The structures
will remain, but will no longer be associated with their
abbreviations. You will be unable to Expand/Contract these
structures. <BR>To add or remove an Attachment Point, right-click on
an atom within the group and select the <B class="buttonName">Group
&gt; Attachment Point</B> checkbox.
</P>

<H2><A class="anchor" NAME="radicals">Working with Radicals</A></H2>
<P>MarvinSketch allows you to specify that an atom in the molecule is a
radical. This functionality is available via the <A HREF="sketch-gui.html#atom.popup" class="buttonName">Atom
Pop-up Menu</A>.<BR>To change an atom into a radical,
right-click on it to access the Atom Pop-up Menu. Select the type of
radical from the <B class="buttonName">Radicals</B>
submenu. A radical symbol will appear next to the atom and a valence
check will be run with errors highlighted.
</P>

<H2><A class="anchor" NAME="query-guide">Query Guide</A></H2>
<P>The <A HREF="http://www.chemaxon.com/jchem/doc/user/query.html">JChem
query guide</A> provides more detailed information on
how to use query structures created in MarvinSketch with JChem's query functionality.
The following are some of the query building features available in
MarvinSketch.
</P>

<H2><A class="anchor" NAME="rgroups">R-groups</A></H2>
<P>MarvinSketch allows you to specify R-groups within your molecule. These
R-groups can be very useful in <A HREF="http://www.chemaxon.com/jchem/doc/user/query.html#markush">R-group
queries</A>. An R-group is a variable representing a
user-defined list of structures. Using R-groups in a query structure
can allow you to quickly search for a wide range of substructure hits
using only a single query. <BR>You can set or change the R-group
label of a molecule node from the <A HREF="sketch-gui.html#atom.popup" class="buttonName">Atom
Pop-up Menu</A> or by typing the corresponding R-group label on the keyboard.
<BR>To define the set of structures that are represented by an R-group label,
<SPAN LANG="en-US"> select the </SPAN>structures you wish to include. Then, select the
corresponding label from the <B class="buttonName">Periodic
Table</B> or use one of type the R-group <A HREF="sketch-basic.html#shortcuts">label
on the keyboard</A>. Set additional Occurence, RestH and If-then conditions for the query
in the R-logic dialog available from the Edit/Attributes menu.
</P>

<H2><A class="anchor" NAME="atomlist">Atom Lists</A></H2>
<P>MarvinSketch allows you to add Atom List query atoms to your molecule.
An Atom List is a user-defined list of elements included in a query
structure, any of which will produce a hit if found in the target.
</P>
<P>You can add Atom Lists to your molecule through the <B class="buttonName">Periodic
Table.</B>  To add an Atom List to the molecule, select the <B class="buttonName">Atom
List</B> button, then select the elements you wish to
include in the list. Move the mouse into the canvas and click to add a query atom representing this atom list.
</P>

<H2><A class="anchor" NAME="notlist">Not Lists</A></H2>
<P>A Not List is a query atom that allows you to define a list of
elements that should not be included in the target structure. If an
atom within the query structure is set as a Not List, then the atom
in the same position within the target structure can be any atom that
is not on the list to produce a hit. <BR>To add a Not List to the
molecule, select the <B class="buttonName">Not
List</B> button in the <B class="buttonName">Periodic
Table</B>, then select the elements you wish to include in
the list.
Move the mouse into the canvas and click to add a query atom representing
this not list.
</P>

<H2><A class="anchor" NAME="generic-atoms">Generic Atoms</A></H2>
<P>Generic atoms can be added to include a wide range of elements in
a query structure. Currently, MarvinSketch supports two types of generic
atoms: <B class="buttonName">Any</B>
and <B class="buttonName">Hetero</B>
<BR>If an atom within the query structure is designated as &quot;Any&quot;,
any atom at this position in the target structure will produce a hit.
<BR>If an atom within the query structure is designated as &quot;Q&quot;,
then the atom at this position can be any heteroatom (i.e. any atom
except hydrogen or carbon) and it will produce a hit. <BR>To add a
generic atom to the molecule, select one of the generic atom types
from the <B class="buttonName">Periodic
Table</B> and place it on the canvas with the mouse.
</P>

<H2><A class="anchor" NAME="atom-props">Atom Properties</A></H2>
<P>You can define the chemical neighborhood for an atom within a
query structure. MarvinSketch allows you to set properties, such as
hydrogen count, valence count, ring size, and aromaticity, which must
be matched by the corresponding atom in the target structure to
produce a hit. <BR>To set or change atom properties, select an atom
property button from the <B class="buttonName">Periodic
Table</B>. To apply this property, click on the desired atom.
</P>
<P ALIGN=CENTER><A HREF="#">Return to Top</A></P>
<p ALIGN=CENTER>
Copyright &copy; 1998-2009
<a HREF="http://www.chemaxon.com">ChemAxon Ltd.</a>
</p>
<p ALIGN=CENTER>
<a HREF="http://www.chemaxon.com/marvin">http://www.chemaxon.com/marvin</a>
</p>

</BODY>
</HTML>